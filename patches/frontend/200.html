<!doctype html>
<html>

<head>
  <meta data-n-head="1" charset="utf-8">
  <meta data-n-head="1" name="viewport" content="width=device-width,initial-scale=1">
  <meta data-n-head="1" data-hid="description" name="description"
    content="Monlam Tools - à½˜à½¼à½“à¼‹à½£à½˜à¼‹ annotation tools for Tibetan language AI">
  <title>Monlam Tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon.png">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon.png">
  <link rel="preload" href="/static/_nuxt/08fba5f.js" as="script">
  <link rel="preload" href="/static/_nuxt/132fcbd.js" as="script">
  <link rel="preload" href="/static/_nuxt/50aa8ea.js" as="script">
  <link rel="preload" href="/static/_nuxt/bd0aa1f.js" as="script">
  <style>
    /* Monlam Tools Custom Branding */
    :root {
      --monlam-gold: #B8963E;
      --monlam-gold-dark: #9A7B32;
      --monlam-navy: #1a1a2e;
      --monlam-font: 'MonlamTBslim', 'Noto Sans Tibetan', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .navbar.is-primary {
      background-color: var(--monlam-navy) !important;
    }

    .button.is-primary {
      background-color: var(--monlam-gold) !important;
      border-color: var(--monlam-gold) !important;
    }

    .button.is-primary:hover {
      background-color: var(--monlam-gold-dark) !important;
    }

    a.has-text-primary {
      color: var(--monlam-gold) !important;
    }

    .tag.is-primary {
      background-color: var(--monlam-gold) !important;
    }

    .menu-list a.is-active {
      background-color: var(--monlam-gold) !important;
    }

    .progress.is-primary::-webkit-progress-value {
      background-color: var(--monlam-gold) !important;
    }

    .tabs.is-toggle li.is-active a {
      background-color: var(--monlam-gold) !important;
      border-color: var(--monlam-gold) !important;
    }

    .pagination-link.is-current {
      background-color: var(--monlam-gold) !important;
      border-color: var(--monlam-gold) !important;
    }

    /* Hide GitHub button and link */
    a[href*="github.com"],
    a[href*="GITHUB"],
    button[class*="github"],
    .github-button {
      display: none !important;
    }

    /* ========================================
         MonlamTBslim FONT - Roboto deleted from build
         ======================================== */

    /* Primary MonlamTBslim font-face */
    @font-face {
      font-family: 'MonlamTBslim';
      src: local('MonlamTBslim'),
        url('/static/fonts/MonlamTBslim.woff2') format('woff2'),
        url('/static/fonts/MonlamTBslim.woff') format('woff'),
        url('/static/fonts/MonlamTBslim.ttf') format('truetype');
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }

    /* Roboto fallback - when Roboto is requested, use MonlamTBslim */
    @font-face {
      font-family: 'Roboto';
      src: local('MonlamTBslim'),
        url('/static/fonts/MonlamTBslim.woff2') format('woff2'),
        url('/static/fonts/MonlamTBslim.woff') format('woff'),
        url('/static/fonts/MonlamTBslim.ttf') format('truetype');
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }

    /* Apply MonlamTBslim everywhere */
    *,
    *::before,
    *::after {
      font-family: var(--monlam-font) !important;
    }

    /* Fix Tibetan vowel marks (à½² à½´) being cut off - need extra line-height */
    html,
    html body,
    html body *,
    .v-application,
    .v-application *,
    .v-btn,
    .v-list-item,
    .v-menu__content,
    .v-select__selection,
    .v-toolbar__title,
    .v-tab,
    label,
    span,
    p,
    div,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      line-height: 1.8 !important;
    }

    /* Extra padding for menu items and buttons */
    .v-btn {
      padding-top: 4px !important;
      padding-bottom: 4px !important;
      min-height: 40px !important;
    }

    .v-list-item {
      min-height: 48px !important;
      padding-top: 8px !important;
      padding-bottom: 8px !important;
    }

    .v-tab {
      padding-top: 8px !important;
      padding-bottom: 8px !important;
    }

    .v-chip {
      height: auto !important;
      min-height: 32px !important;
      padding-top: 4px !important;
      padding-bottom: 4px !important;
    }

    .v-text-field input,
    .v-text-field textarea {
      padding-top: 8px !important;
      padding-bottom: 8px !important;
      line-height: 1.8 !important;
    }

  </style>
</head>

<body>
  <div id="__nuxt">
    <style>
      #nuxt-loading {
        background: #fff;
        visibility: hidden;
        opacity: 0;
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        animation: nuxtLoadingIn 10s ease;
        -webkit-animation: nuxtLoadingIn 10s ease;
        animation-fill-mode: forwards;
        overflow: hidden
      }

      @keyframes nuxtLoadingIn {
        0% {
          visibility: hidden;
          opacity: 0
        }

        20% {
          visibility: visible;
          opacity: 0
        }

        100% {
          visibility: visible;
          opacity: 1
        }
      }

      @-webkit-keyframes nuxtLoadingIn {
        0% {
          visibility: hidden;
          opacity: 0
        }

        20% {
          visibility: visible;
          opacity: 0
        }

        100% {
          visibility: visible;
          opacity: 1
        }
      }

      #nuxt-loading>div,
      #nuxt-loading>div:after {
        border-radius: 50%;
        width: 5rem;
        height: 5rem
      }

      #nuxt-loading>div {
        font-size: 10px;
        position: relative;
        text-indent: -9999em;
        border: .5rem solid #f5f5f5;
        border-left: .5rem solid #B8963E;
        -webkit-transform: translateZ(0);
        -ms-transform: translateZ(0);
        transform: translateZ(0);
        -webkit-animation: nuxtLoading 1.1s infinite linear;
        animation: nuxtLoading 1.1s infinite linear
      }

      #nuxt-loading.error>div {
        border-left: .5rem solid #ff4500;
        animation-duration: 5s
      }

      @-webkit-keyframes nuxtLoading {
        0% {
          -webkit-transform: rotate(0);
          transform: rotate(0)
        }

        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg)
        }
      }

      @keyframes nuxtLoading {
        0% {
          -webkit-transform: rotate(0);
          transform: rotate(0)
        }

        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg)
        }
      }
    </style>
    <script>window.addEventListener("error", function () { var e = document.getElementById("nuxt-loading"); e && (e.className += " error") })</script>
    <div id="nuxt-loading" aria-live="polite" role="status">
      <div>Loading...</div>
    </div>
  </div>
  <script>window.__NUXT__ = { config: { _app: { basePath: "/", assetsPath: "/static/_nuxt/", cdnURL: null } } }</script>
  <script>
    // Tibetan translations for Monlam Tools (Doccano)
    const translations = {
      // Home page
      'Text Annotation for Humans': 'à½žà½´à¼‹à½‘à½‚à¼‹à½–à¾±à¼‹à½¡à½´à½£à¼',
      'Get Started': 'à½ à½‚à½¼à¼‹à½–à½¢à¾©à½˜à½¦à¼',
      'GET STARTED': 'à½ à½‚à½¼à¼‹à½–à½¢à¾©à½˜à½¦à¼',
      'The best features': 'à½‘à½˜à½²à½‚à½¦à¼‹à½–à½¦à½£à¼‹à½à¾±à½‘à¼‹à½†à½¼à½¦à¼',
      'Team Collaboration': 'à½šà½¼à½‚à½¦à¼‹à½”à½ à½²à¼‹à½˜à½‰à½˜à¼‹à½£à½¦à¼',
      'Annotation with your team mates': 'à½à¾±à½¼à½‘à¼‹à½€à¾±à½²à¼‹à½£à½¦à¼‹à½¢à½¼à½‚à½¦à¼‹à½‘à½„à¼‹à½˜à½‰à½˜à¼‹à½‘à½´à¼‹à½˜à½†à½“à¼‹à½ à½‚à½¼à½‘à¼',
      'Any Language': 'à½¦à¾à½‘à¼‹à½¢à½²à½‚à½¦à¼‹à½‚à½„à¼‹à½¡à½„à¼‹à¼',
      'Annotation with any language': 'à½¦à¾à½‘à¼‹à½¢à½²à½‚à½¦à¼‹à½‚à½„à¼‹à½¡à½„à¼‹à½¢à½´à½„à¼‹à½–à½ à½²à¼‹à½˜à½†à½“à¼‹à½ à½‚à½¼à½‘à¼',
      'Open Source': 'à½£à½¦à¼‹à½¦à¾³à¼‹à½”à½¼à¼',
      'Annotation that is free and customizable': 'à½¢à½²à½“à¼‹à½˜à½ºà½‘à¼‹à½‘à½„à¼‹à½¢à½„à¼‹à½˜à½¼à½¦à¼‹à½–à½Ÿà½¼à¼‹à½–à½…à½¼à½¦à¼‹à½–à¾±à½ºà½‘à¼‹à½¢à½´à½„à¼‹à½–à½ à½²à¼‹à½˜à½†à½“à¼‹à½ à½‚à½¼à½‘à¼',
      'Realize your ideas quickly': 'à½à¾±à½¼à½‘à¼‹à½€à¾±à½²à¼‹à½–à½¦à½˜à¼‹à½–à¾³à½¼à¼‹à½˜à½‚à¾±à½¼à½‚à½¦à¼‹à½”à½¼à½¢à¼‹à½‘à½„à½¼à½¦à¼‹à½¦à½´à¼‹à½¦à¾’à¾²à½´à½–à¼',
      'Try Demo': 'à½šà½¼à½‘à¼‹à½£à¾Ÿà¼‹à½–à¾±à½ºà½‘à¼',
      'TRY DEMO': 'à½šà½¼à½‘à¼‹à½£à¾Ÿà¼‹à½–à¾±à½ºà½‘à¼',

      // Navigation
      'Login': 'à½“à½„à¼‹à½ à½›à½´à½£à¼',
      'LOGIN': 'à½“à½„à¼‹à½ à½›à½´à½£à¼',
      'Sign Out': 'à½•à¾±à½²à½¢à¼‹à½ à½à½¼à½“à¼',
      'Projects': 'à½£à½¦à¼‹à½‚à½žà½²à¼',
      'PROJECTS': 'à½£à½¦à¼‹à½‚à½žà½²à¼',

      // Project home
      'Home': 'à½˜à½‘à½´à½“à¼‹à½„à½¼à½¦à¼',
      'Welcome to Doccano!': 'à½¦à¾à½´à¼‹à½à½˜à½¦à¼‹à½–à½Ÿà½„à¼‹à¼',
      'Welcome to Monlam Tools!': 'à½¦à¾à½´à¼‹à½à½˜à½¦à¼‹à½–à½Ÿà½„à¼‹à¼',
      'Import a dataset': 'à½‚à½žà½²à¼‹à½‚à¾²à½„à½¦à¼‹à½“à½„à¼‹à½ à½‘à¾²à½ºà½“à¼',
      'Create labels for this project': 'à½£à½¦à¼‹à½‚à½žà½²à¼‹à½ à½‘à½²à½ à½²à¼‹à½†à½ºà½‘à¼‹à½à¼‹à½–à¾±à½„à¼‹à½‚à½¦à½¢à¼‹à½–à½Ÿà½¼à¼',
      'Add members for collaborative work': 'à½˜à½‰à½˜à¼‹à½£à½¦à¼‹à½€à¾±à½²à¼‹à½†à½ºà½‘à¼‹à½šà½¼à½‚à½¦à¼‹à½˜à½²à¼‹à½¦à¾£à½¼à½“à¼‹à½”à¼',
      'Define a guideline for the work': 'à½£à½¦à¼‹à½€à½ à½²à¼‹à½£à½˜à¼‹à½¦à¾Ÿà½¼à½“à¼‹à½‚à½à½“à¼‹à½ à½à½ºà½£à¼',
      'Annotate the dataset': 'à½‚à½žà½²à¼‹à½‚à¾²à½„à½¦à¼‹à½£à¼‹à½˜à½†à½“à¼‹à½ à½‚à½¼à½‘à¼',
      'View statistics': 'à½šà½‘à¼‹à½‚à½žà½²à¼‹à½£à¾Ÿà¼‹à½–à¼',
      'Export the dataset': 'à½‚à½žà½²à¼‹à½‚à¾²à½„à½¦à¼‹à½•à¾±à½²à½¢à¼‹à½ à½‘à¾²à½ºà½“à¼',

      // Common
      'Save': 'à½‰à½¢à¼‹à½šà½‚à½¦à¼',
      'Edit': 'à½¢à¾©à½¼à½˜à¼‹à½¦à¾’à¾²à½²à½‚',
      'Create': 'à½‚à½¦à½¢à¼‹à½–à½Ÿà½¼à¼',
      'Cancel': 'à½ à½‘à½¼à½¢à¼‹à½–à¼',
      'Close': 'à½¦à¾’à½¼à¼‹à½¢à¾’à¾±à½‚',
      'Delete': 'à½–à½¦à½´à½–à¼‹à½”à¼',
      'Search': 'à½–à½™à½£à¼‹à½žà½²à½–à¼',
      'Import': 'à½“à½„à¼‹à½ à½‘à¾²à½ºà½“à¼',
      'Export': 'à½•à¾±à½²à½¢à¼‹à½ à½‘à¾²à½ºà½“à¼',
      'Add': 'à½¦à¾£à½¼à½“à¼‹à½”à¼',
      'Upload': 'à½¦à¾à¾±à½ºà½£à¼‹à½ à½‡à½´à½‚',
      'Yes': 'à½¡à½²à½“à¼',
      'No': 'à½˜à½²à½“à¼',
      'Loading...': 'à½¦à¾£à½“à¼‹à½–à½žà½²à½“à¼‹à½”à¼...',
      'Loading... Please wait': 'à½¦à¾£à½“à¼‹à½–à½žà½²à½“à¼‹à½”à¼ à½¦à¾’à½´à½‚à¼‹à½¢à½¼à½‚à½¦à¼',

      // Labels/Annotation
      'Labels': 'à½à¼‹à½–à¾±à½„à¼‹à¼',
      'Dataset': 'à½‚à½žà½²à¼‹à½‚à¾²à½„à½¦à¼',
      'Members': 'à½šà½¼à½‚à½¦à¼‹à½˜à½²à¼',
      'Guideline': 'à½£à½˜à¼‹à½¦à¾Ÿà½¼à½“à¼',
      'Statistics': 'à½šà½‘à¼‹à½‚à½žà½²à¼',
      'Metrics': 'à½šà½‘à¼‹à½‚à½žà½²à¼',
      'Settings': 'à½¦à¾’à¾²à½²à½‚à¼‹à½ à½‚à½¼à½‘à¼',
      'Comments': 'à½˜à½†à½“à¼',

      // Demo types
      'Named Entity Recognition': 'à½˜à½²à½„à¼‹à½šà½²à½‚à¼‹à½‘à½–à¾±à½ºà¼‹à½ à½–à¾±à½ºà½‘à¼',
      'Sentiment Analysis': 'à½¦à½ºà½˜à½¦à¼‹à½šà½¼à½¢à¼‹à½‘à½–à¾±à½ºà¼‹à½žà½²à½–à¼',
      'Translation': 'à½¡à½²à½‚à¼‹à½¦à¾’à¾±à½´à½¢à¼',
      'Text to SQL': 'à½¡à½²à¼‹à½‚à½ºà¼‹à½“à½¦à¼‹SQL',
      'Intent Detection and Slot Filling': 'à½‘à½˜à½²à½‚à½¦à¼‹à½–à½¦à½£à¼‹à½ à½šà½¼à½£à¼‹à½žà½²à½–à¼',
      'Image Classification': 'à½”à½¢à¼‹à½¢à½²à½¦à¼‹à½‘à½–à¾±à½ºà¼‹à½ à½–à¾±à½ºà½‘à¼',
      'Image Captioning': 'à½”à½¢à¼‹à½¢à½²à½¦à¼‹à½ à½‚à¾²à½ºà½£à¼‹à½–à½¤à½‘à¼',
      'Object Detection': 'à½‘à½„à½¼à½¦à¼‹à½”à½¼à¼‹à½ à½šà½¼à½£à¼‹à½žà½²à½–à¼',
      'Polygon Segmentation': 'à½˜à½à½ à¼‹à½¢à½²à½¦à¼‹à½‘à½–à¾±à½ºà¼‹à½–à½žà½‚',
      'Speech to Text': 'à½¦à¾à½‘à¼‹à½†à¼‹à½“à½¦à¼‹à½¡à½²à¼‹à½‚à½ºà¼',

      // Project types
      'Text Classification': 'à½¡à½²à¼‹à½‚à½ºà¼‹à½‘à½–à¾±à½ºà¼‹à½ à½–à¾±à½ºà½‘à¼',
      'Sequence Labeling': 'à½˜à½šà½˜à½¦à¼‹à½¢à½²à½¦à¼‹à½à¼‹à½–à¾±à½„à¼‹à¼',
      'Sequence to sequence': 'à½˜à½šà½˜à½¦à¼‹à½“à½¦à¼‹à½˜à½šà½˜à½¦à¼',

      // Doccano branding
      'doccano': 'Monlam Tools',
      'Doccano': 'Monlam Tools',
      'Monlam AI': 'Monlam Tools',

      // Copyright - fix year to 2026
      'Â© 2025 Monlam Tools': 'Â© 2026 Monlam Tools',
      'Â© 2026 Monlam AI': 'Â© 2026 Monlam Tools',

    };

    document.addEventListener('DOMContentLoaded', function () {
      // Update title
      document.title = 'Monlam Tools';

      // ========================================
      // Force Monlam favicon (override any Nuxt.js defaults)
      // ========================================
      function setFavicon() {
        // Remove existing favicons
        document.querySelectorAll('link[rel*="icon"]').forEach(function (link) {
          if (!link.href.includes('favicon.ico') && !link.href.includes('favicon.png')) {
            link.remove();
          }
        });

        // Ensure our favicon links exist
        const head = document.head;
        const existingIco = document.querySelector('link[href="/favicon.ico"]');
        if (!existingIco) {
          const ico = document.createElement('link');
          ico.rel = 'icon';
          ico.type = 'image/x-icon';
          ico.href = '/favicon.ico';
          head.appendChild(ico);
        }
      }
      setFavicon();

      function replaceText(element) {
        // Update title dynamically
        if (document.title.includes('doccano')) {
          document.title = 'Monlam Tools';
        }

        // Walk through all text nodes
        const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false);
        let node;
        while (node = walker.nextNode()) {
          let text = node.nodeValue;
          let changed = false;

          // Check each translation
          for (const [eng, tib] of Object.entries(translations)) {
            if (text.includes(eng)) {
              text = text.replace(new RegExp(eng.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), tib);
              changed = true;
            }
          }

          if (changed) {
            node.nodeValue = text;
          }
        }
      }

      // Observe DOM changes
      const observer = new MutationObserver(function (mutations) {
        mutations.forEach(function (mutation) {
          if (mutation.type === 'childList') {
            mutation.addedNodes.forEach(function (node) {
              if (node.nodeType === Node.ELEMENT_NODE) {
                replaceText(node);
              }
            });
          }
        });
      });

      observer.observe(document.body, { childList: true, subtree: true });

      // Initial replacement
      replaceText(document.body);

      // Periodic check
      setInterval(function () {
        replaceText(document.body);
        // Remove GitHub buttons/links
        document.querySelectorAll('a[href*="github"], button').forEach(function (el) {
          if (el.textContent.toLowerCase().includes('github')) {
            el.style.display = 'none';
          }
        });
      }, 1000);

      // ========================================
      // Review Button Styling: Red O / Green Check
      // ========================================
      const CLOSE_PATH = "M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z";
      const CHECK_PATH = "M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z";
      const CIRCLE_PATH = "M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z";

      function styleReviewButtons() {
        document.querySelectorAll('.v-btn--icon .v-icon svg path').forEach(function (path) {
          const d = path.getAttribute('d');
          // X icon -> Red Circle
          if (d === CLOSE_PATH) {
            path.setAttribute('d', CIRCLE_PATH);
            path.style.fill = '#f44336';
          }
          // Check icon -> Green
          else if (d === CHECK_PATH) {
            path.style.fill = '#4caf50';
          }
        });
      }

      // Run periodically to catch dynamic updates
      setInterval(styleReviewButtons, 500);
      styleReviewButtons();

      // ========================================
      // FORCE MonlamTBslim font - override Vuetify's runtime Roboto injection
      // ========================================
      const MONLAM_FONT = "'MonlamTBslim', 'Noto Sans Tibetan', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif";

      function forceMonlamFont() {
        // Override on html and body elements
        document.documentElement.style.setProperty('font-family', MONLAM_FONT, 'important');
        document.body.style.setProperty('font-family', MONLAM_FONT, 'important');

        // Override on v-application (Vuetify root)
        document.querySelectorAll('.v-application').forEach(function (el) {
          el.style.setProperty('font-family', MONLAM_FONT, 'important');
        });

        // Override all elements that Vuetify typically styles
        document.querySelectorAll('h1, h2, h3, h4, h5, h6, .display-1, .display-2, .headline, .title, .subtitle-1, .subtitle-2, .body-1, .body-2, .v-btn, .v-card, .v-list-item, .v-toolbar__title, .v-tab, span, p, div, label, input, textarea').forEach(function (el) {
          el.style.setProperty('font-family', MONLAM_FONT, 'important');
          el.style.setProperty('line-height', '1.8', 'important');
        });
      }

      // Run immediately and frequently to override Vuetify
      forceMonlamFont();
      setInterval(forceMonlamFont, 500);

      // Also run after page fully loads
      window.addEventListener('load', function () {
        forceMonlamFont();
        setTimeout(forceMonlamFont, 100);
        setTimeout(forceMonlamFont, 500);
        setTimeout(forceMonlamFont, 1000);
      });


    });
  </script>
  <script src="/static/_nuxt/08fba5f.js"></script>
  <script src="/static/_nuxt/132fcbd.js"></script>
  <script src="/static/_nuxt/50aa8ea.js"></script>
  <script src="/static/_nuxt/bd0aa1f.js"></script>
  
  <!-- Monlam Features - Inline for Maximum Reliability -->
  <script>
(function() {
    'use strict';
    
    console.log('[Monlam Inline] Features loading...');
    
    const CONFIG = {
        maxRetries: 50,
        retryDelay: 200,
        projectId: null
    };
    
    // UTILITIES
    function getProjectId() {
        const match = window.location.pathname.match(/\/projects\/(\d+)/);
        return match ? match[1] : null;
    }
    
    function waitForElement(selector, callback, retries = 0) {
        const element = document.querySelector(selector);
        if (element) {
            console.log(`[Monlam] Found element: ${selector}`);
            callback(element);
        } else if (retries < CONFIG.maxRetries) {
            setTimeout(() => waitForElement(selector, callback, retries + 1), CONFIG.retryDelay);
        } else {
            console.log(`[Monlam] Timeout waiting for: ${selector}`);
        }
    }
    
    function waitForElements(selector, callback, retries = 0) {
        const elements = document.querySelectorAll(selector);
        if (elements.length > 0) {
            console.log(`[Monlam] Found ${elements.length} elements: ${selector}`);
            callback(elements);
        } else if (retries < CONFIG.maxRetries) {
            setTimeout(() => waitForElements(selector, callback, retries + 1), CONFIG.retryDelay);
        }
    }
    
    // FEATURE 1: AUDIO AUTO-LOOP
    function enableAudioLoop() {
        const path = window.location.pathname;
        const isAnnotationPage = path.includes('/speech-to-text') || path.match(/\/projects\/\d+\/\d+$/);
        
        if (!isAnnotationPage) {
            console.log('[Monlam Audio] Not on annotation page');
            return;
        }
        
        console.log('[Monlam Audio] Enabling audio loop...');
        
        function applyLoop(audio) {
            if (!audio.hasAttribute('data-monlam-loop')) {
                audio.loop = true;
                audio.setAttribute('data-monlam-loop', 'true');
                
                if (audio.readyState >= 2) {
                    audio.play().catch(e => {
                        console.log('[Monlam Audio] Auto-play blocked, waiting for interaction');
                        document.addEventListener('click', () => audio.play(), { once: true });
                    });
                } else {
                    audio.addEventListener('canplay', () => {
                        audio.play().catch(e => {
                            document.addEventListener('click', () => audio.play(), { once: true });
                        });
                    }, { once: true });
                }
                
                console.log('[Monlam Audio] Loop enabled');
            }
        }
        
        waitForElements('audio', (audioElements) => {
            audioElements.forEach(applyLoop);
        });
        
        const observer = new MutationObserver(() => {
            document.querySelectorAll('audio:not([data-monlam-loop])').forEach(applyLoop);
        });
        observer.observe(document.body, { childList: true, subtree: true });
    }
    
    // FEATURE 2: DATASET COLUMNS
    function addDatasetColumns() {
        const isDatasetPage = window.location.pathname.includes('/dataset');
        if (!isDatasetPage) return;
        
        console.log('[Monlam Dataset] Adding completion columns...');
        CONFIG.projectId = getProjectId();
        
        let assignmentData = {};
        
        fetch(`/v1/projects/${CONFIG.projectId}/assignments/`)
            .then(r => r.json())
            .then(data => {
                const assignments = data.results || data;
                assignments.forEach(a => {
                    assignmentData[a.example_id] = a;
                });
                console.log('[Monlam Dataset] Loaded', Object.keys(assignmentData).length, 'assignments');
                injectColumns();
            })
            .catch(e => console.error('[Monlam Dataset] Failed:', e));
        
        function injectColumns() {
            waitForElement('thead tr', (headerRow) => {
                if (headerRow.querySelector('.monlam-col')) return;
                
                const th = document.createElement('th');
                th.className = 'monlam-col text-start';
                th.innerHTML = '<span style="font-weight: 600;">ðŸ‘¤ Assigned To</span>';
                th.style.cssText = 'padding: 12px; background: #f5f5f5;';
                headerRow.appendChild(th);
                
                console.log('[Monlam Dataset] Header added');
            });
            
            const observer = new MutationObserver(() => {
                document.querySelectorAll('tbody tr:not([data-monlam-col])').forEach(row => {
                    row.setAttribute('data-monlam-col', 'true');
                    
                    // Get example ID from Cell 1 (ID column)
                    const cells = row.querySelectorAll('td');
                    if (cells.length < 2) return;
                    
                    const exampleId = cells[1].textContent.trim();
                    if (!exampleId || !/^\d+$/.test(exampleId)) return;
                    
                    const assignment = assignmentData[exampleId];
                    
                    const td = document.createElement('td');
                    td.className = 'monlam-col text-start';
                    td.style.cssText = 'padding: 12px;';
                    
                    if (assignment) {
                        td.innerHTML = `
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span style="background: #2196F3; color: white; padding: 4px 10px; border-radius: 12px; font-size: 11px; display: inline-block; width: fit-content;">
                                    ðŸ“‹ ${assignment.status}
                                </span>
                                <span style="font-size: 10px; color: #666;">${assignment.assigned_to_username || 'N/A'}</span>
                            </div>
                        `;
                    } else {
                        td.innerHTML = '<span style="color: #999; font-size: 12px;">Not assigned</span>';
                    }
                    
                    row.appendChild(td);
                });
            });
            
            waitForElement('tbody', (tbody) => {
                observer.observe(tbody, { childList: true, subtree: true });
                observer.disconnect();
                observer.observe(tbody, { childList: true, subtree: true });
            });
        }
    }
    
    // FEATURE 3: METRICS MATRIX
    function addMetricsMatrix() {
        const isMetricsPage = window.location.pathname.endsWith('/metrics');
        if (!isMetricsPage) return;
        
        console.log('[Monlam Metrics] Adding completion matrix...');
        CONFIG.projectId = getProjectId();
        
        Promise.all([
            fetch(`/v1/projects/${CONFIG.projectId}/assignments/completion-matrix/summary/`).then(r => r.json()),
            fetch(`/v1/projects/${CONFIG.projectId}/assignments/completion-matrix/annotators/`).then(r => r.json()),
        ]).then(([summary, annotators]) => {
            console.log('[Monlam Metrics] Data fetched:', summary, annotators);
            injectMatrix(summary, annotators);
        }).catch(e => console.error('[Monlam Metrics] Failed:', e));
        
        function injectMatrix(summary, annotators) {
            waitForElement('main', (main) => {
                if (main.querySelector('.monlam-metrics')) return;
                
                const section = document.createElement('div');
                section.className = 'monlam-metrics';
                section.style.cssText = 'margin: 20px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);';
                
                section.innerHTML = `
                    <h2 style="margin-bottom: 20px; color: #1976D2;">ðŸ“Š Project Completion Tracking</h2>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 30px;">
                        <div style="background: #E3F2FD; padding: 16px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Total Examples</div>
                            <div style="font-size: 32px; font-weight: bold; color: #1976D2;">${summary.total_examples}</div>
                        </div>
                        <div style="background: #E8F5E9; padding: 16px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Assigned</div>
                            <div style="font-size: 32px; font-weight: bold; color: #4CAF50;">${summary.assigned_examples}</div>
                        </div>
                        <div style="background: #FFF3E0; padding: 16px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Completed</div>
                            <div style="font-size: 32px; font-weight: bold; color: #FF9800;">${summary.completed_examples}</div>
                        </div>
                        <div style="background: #F3E5F5; padding: 16px; border-radius: 8px;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Approved</div>
                            <div style="font-size: 32px; font-weight: bold; color: #9C27B0;">${summary.approved_examples}</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-bottom: 16px;">Annotators Progress</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f5f5f5;">
                                <th style="padding: 12px; text-align: left;">User</th>
                                <th style="padding: 12px; text-align: center;">Assigned</th>
                                <th style="padding: 12px; text-align: center;">Completed</th>
                                <th style="padding: 12px; text-align: center;">Progress</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${annotators.map(a => `
                                <tr style="border-bottom: 1px solid #eee;">
                                    <td style="padding: 12px;">${a.username}</td>
                                    <td style="padding: 12px; text-align: center;">${a.assigned_count}</td>
                                    <td style="padding: 12px; text-align: center;">${a.completed_count}</td>
                                    <td style="padding: 12px;">
                                        <div style="background: #eee; border-radius: 4px; overflow: hidden; height: 20px;">
                                            <div style="background: #4CAF50; height: 100%; width: ${a.completion_rate}%;"></div>
                                        </div>
                                        <span style="font-size: 11px; color: #666;">${a.completion_rate}%</span>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                main.appendChild(section);
                console.log('[Monlam Metrics] Matrix injected');
            });
        }
    }
    
    // FEATURE 4: APPROVE/REJECT BUTTONS
    function addApproveButtons() {
        const path = window.location.pathname;
        const isAnnotationPage = path.includes('/speech-to-text') || path.match(/\/projects\/\d+\/\d+$/);
        
        if (!isAnnotationPage) return;
        
        console.log('[Monlam Approve] Adding buttons...');
        CONFIG.projectId = getProjectId();
        
        const match = path.match(/\/projects\/\d+\/(\d+)/);
        if (!match) return;
        const exampleId = match[1];
        
        waitForElement('main', (main) => {
            if (main.querySelector('.monlam-approve-btns')) return;
            
            const container = document.createElement('div');
            container.className = 'monlam-approve-btns';
            container.style.cssText = 'position: fixed; top: 80px; right: 20px; z-index: 1000; display: flex; gap: 12px;';
            
            container.innerHTML = `
                <button class="approve-btn" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(76,175,80,0.3);">
                    âœ“ Approve
                </button>
                <button class="reject-btn" style="background: #F44336; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(244,67,54,0.3);">
                    âœ— Reject
                </button>
            `;
            
            container.querySelector('.approve-btn').onclick = () => {
                fetch(`/v1/projects/${CONFIG.projectId}/assignments/approver-completion/${exampleId}/approve/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRFToken': getCsrfToken() },
                    body: JSON.stringify({ review_notes: '' })
                }).then(r => {
                    if (r.ok) {
                        alert('âœ… Approved!');
                        container.querySelector('.approve-btn').disabled = true;
                    }
                });
            };
            
            container.querySelector('.reject-btn').onclick = () => {
                const notes = prompt('Rejection reason:');
                if (!notes) return;
                
                fetch(`/v1/projects/${CONFIG.projectId}/assignments/approver-completion/${exampleId}/reject/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-CSRFToken': getCsrfToken() },
                    body: JSON.stringify({ review_notes: notes })
                }).then(r => {
                    if (r.ok) {
                        alert('âœ— Rejected');
                        container.querySelector('.reject-btn').disabled = true;
                    }
                });
            };
            
            document.body.appendChild(container);
            console.log('[Monlam Approve] Buttons added');
        });
    }
    
    function getCsrfToken() {
        const name = 'csrftoken';
        const cookies = document.cookie.split(';');
        for (let cookie of cookies) {
            const [key, value] = cookie.trim().split('=');
            if (key === name) return decodeURIComponent(value);
        }
        return '';
    }
    
    // INITIALIZATION
    function init() {
        console.log('[Monlam] Initializing features...');
        console.log('[Monlam] Current path:', window.location.pathname);
        
        setTimeout(() => {
            enableAudioLoop();
            addDatasetColumns();
            addMetricsMatrix();
            addApproveButtons();
        }, 1000);
        
        let lastPath = window.location.pathname;
        setInterval(() => {
            if (window.location.pathname !== lastPath) {
                lastPath = window.location.pathname;
                console.log('[Monlam] Navigation detected:', lastPath);
                setTimeout(() => {
                    enableAudioLoop();
                    addDatasetColumns();
                    addMetricsMatrix();
                    addApproveButtons();
                }, 500);
            }
        }, 500);
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    
    console.log('[Monlam Inline] Features script loaded');
})();
  </script>
</body>

</html>