# Render Blueprint for Monlam Doccano
# https://render.com/docs/blueprint-spec

services:
  # ===========================================
  # Main Doccano Web Service
  # ===========================================
  - type: web
    name: monlam-doccano
    env: docker
    plan: standard
    region: singapore
    healthCheckPath: /
    envVars:
      - key: ADMIN_USERNAME
        value: admin
      - key: ADMIN_EMAIL
        value: admin@monlam.ai
      - key: ADMIN_PASSWORD
        sync: false
      - key: DATABASE_URL
        fromDatabase:
          name: doccano-db
          property: connectionString
      - key: CELERY_BROKER_URL
        fromService:
          name: doccano-redis
          type: redis
          property: connectionString
      - key: DJANGO_SETTINGS_MODULE
        value: config.settings.production
      - key: DEBUG
        value: "False"
      - key: ALLOW_SIGNUP
        value: "False"
      - key: SECRET_KEY
        generateValue: true

  # ===========================================
  # Redis for Celery Task Queue
  # ===========================================
  - type: redis
    name: doccano-redis
    plan: starter
    region: singapore
    maxmemoryPolicy: allkeys-lru
    ipAllowList: []

# ===========================================
# PostgreSQL Database
# Flexible plans: basic-256mb, basic-512mb, basic-1gb, basic-2gb, basic-4gb
# Pro plans: pro-4gb, pro-8gb, pro-16gb, etc.
# Storage: billed separately at $0.30/GB/month
# ===========================================
databases:
  - name: doccano-db
    plan: basic-1gb
    region: singapore
    databaseName: doccano
    user: doccano
    postgresMajorVersion: "16"
    diskSizeGB: 10
